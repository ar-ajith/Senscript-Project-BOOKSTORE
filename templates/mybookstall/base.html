{% load static %}
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="Untree.co">
    <link rel="icon" type="image/png"  href="{% static 'img/logo.png' %}">
  <meta name="description" content="" />
  <meta name="keywords" content="bootstrap, bootstrap4" />

		<link href="{% static  'mybookstall/css/bootstrap.min.css' %}" rel="stylesheet">
		<link href="{% static 'mybookstall/css/tiny-slider.css' %}" rel="stylesheet">
		<link href="{% static 'mybookstall/css/style.css' %}" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Fontdiner+Swanky&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
<!-- Keep only this -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

		<title>Book Store</title>
                    <style>
                       body {
  opacity: 1;
  transition: opacity 0.4s ease-in-out;
}

/* Remove background-color here */
body.fade-out {
  opacity: 0;
}

/* Custom loading screen image */
#loading-screen {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: transparent;  /* No white background */
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

/* Spinner or image inside */
#loading-screen img {
  width: 120px; /* Adjust size */
  height: auto;
}

/* Show it when loading */
body.loading #loading-screen {
  display: flex;
}

                              a {
                                cursor: pointer;
                            }

/* Loading Spinner */


                #footer{
                    position:absolute;
                    width:100%;
                    background:none

                }
                #wishlist-count{
                  position:relative;
                  right:30%;
                }
                .toast {
                        opacity: 0;
                        transform: translateY(20px);
                        transition: opacity 0.5s ease, transform 0.5s ease;
                      }

                      .toast.show {
                        opacity: 1;
                        transform: translateY(0);
                      }

                      /* Optional: make it rounded and shadowed */
                      .toast {
                        border-radius: 10px;
                        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
                      }
                             
                     .loader-overlay {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background-color: rgba(255, 255, 255, 0.7);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 9999;
                }
                
                .spinner {
                    width: 45px;
                    height: 45px;
                    border: 4px solid #ccc;
                    border-top-color: #15a362;
                    border-radius: 100%;
                    animation: spin 0.6s linear infinite;
                }
                
                @keyframes spin {
                    to {
                        transform: rotate(360deg);
                    }
                }
                    

                

            </style>
</head>
<body >


<div id="loader" class="loader-overlay" style="display: none;">
                    <div class="spinner"></div>
                </div>

  {% comment %} <div id="loading-screen"> {% endcomment %}
  {% comment %} <img src="/static/mybookstall/img/loading.gif" alt="Loading..." />
</div> {% endcomment %}

   <!-- Toast Container -->
   
                <div class="position-fixed top-0 end-0 p-3" style="z-index: 1055;">
                    {% if messages %}
                        {% for message in messages %}
                            {% if message.tags == "success" %}
                                <div class="toast show shadow-lg rounded-3 border-0 animate__animated animate__fadeInUp"
                                     role="alert" aria-live="assertive" aria-atomic="true"
                                     style="min-width: 300px; background-color:#3b5d50;color:white;">
                            {% elif message.tags == "error" or message.tags == "danger" %}
                                <div class="toast show shadow-lg rounded-3 border-0 animate__animated animate__fadeInUp"
                                     role="alert" aria-live="assertive" aria-atomic="true"
                                     style="min-width: 300px; background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); color: #fff;">
                            {% else %}
                                <div class="toast show shadow-lg rounded-3 border-0 animate__animated animate__fadeInUp"
                                     role="alert" aria-live="assertive" aria-atomic="true"
                                     style="min-width: 300px; background: #444; color: #fff;">
                            {% endif %}
                                <div class="d-flex">
                                    <div class="toast-body">
                                        {{ message }}
                                    </div>
                                    <button type="button" class="btn-close btn-close-white me-2 m-auto"
                                            data-bs-dismiss="toast" aria-label="Close"></button>
                                </div>
                            </div>
                        {% endfor %}
                    {% endif %}
                </div>


   
               {% block content %}



            {% endblock %}

   <!-- Start Footer Section -->
<footer class="footer-section py-5" id="footer">
  <div class="container relative">

    <div class="sofa-img mb-4 text-center">
      <img src="{% static 'mybookstall/img/coverimg4.png' %}" alt="Image" class="img-fluid">
    </div>

    <div class="row g-5 mb-5">
      <div class="col-lg-4">
        <div class="mb-4 footer-logo-wrap">
          <a class="app-logo" href="{% url 'user_dashboard' %}"><img class="logo-icon me-2" src="{% static 'img/logo.png' %}" alt="logo">
                        <span class="logo-text" id='text1'>Book Store</span>
                    </a>
        </div>
        <p class="mb-4">
          Your go-to destination for bestsellers, classics, educational books, and more. Explore a world of stories, knowledge, and inspiration all in one place.
        </p>
<ul class="list-unstyled custom-social d-flex">
  <li class="me-3"><a href="#"><span class="fab fa-facebook-f"></span></a></li>
  <li class="me-3"><a href="#"><span class="fab fa-twitter"></span></a></li>
  <li class="me-3"><a href="#"><span class="fab fa-instagram"></span></a></li>
  <li><a href="#"><span class="fab fa-linkedin"></span></a></li>
</ul>

      </div>

      <div class="col-lg-8">
        <div class="row links-wrap">
          <div class="col-6 col-sm-6 col-md-3">
            <ul class="list-unstyled">
              <li><a href="{% url 'about' %}">About us</a></li>
              <li><a href="{% url 'services' %}">Services</a></li>
              <li><a href="{% url 'blog' %}">Blog</a></li>
              <li><a href="{% url 'contact' %}">Contact us</a></li>
            </ul>
          </div>
          <div class="col-6 col-sm-6 col-md-3">
            <ul class="list-unstyled">
              <li><a href="#">Support</a></li>
              <li><a href="#">Knowledge base</a></li>
              <li><a href="#">Live chat</a></li>
            </ul>
          </div>
          <div class="col-6 col-sm-6 col-md-3">
            <ul class="list-unstyled">
              <li><a href="#">Jobs</a></li>
              <li><a href="#">Our team</a></li>
              <li><a href="#">Leadership</a></li>
              <li><a href="/account/shipping-policy" class="no-loader" data-bs-toggle="modal" data-bs-target="#shippingPolicyModal">Shipping Policy</a></li>
              
                <!-- Shipping Policy Modal -->
<div class="modal fade" id="shippingPolicyModal" tabindex="-1" aria-labelledby="shippingPolicyModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="shippingPolicyModalLabel">
          <i class="bi bi-truck me-2 text-primary"></i>Shipping Policy
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <div class="modal-body">
        <div class="card mb-3">
          <div class="card-body">
            <h6 class="card-title">Delivery Timeframes</h6>
            <p class="card-text">
              Orders are processed in 1-2 business days.
              <ul>
                <li>Metro Cities: 2–4 business days</li>
                <li>Other Areas: 4–7 business days</li>
              </ul>
            </p>
          </div>
        </div>

        <div class="card mb-3">
          <div class="card-body">
            <h6 class="card-title">Shipping Charges</h6>
            <p class="card-text">
              Free shipping on orders above ₹500.<br>
              ₹50 charge for orders below ₹500.
            </p>
          </div>
        </div>

        <div class="card mb-3">
          <div class="card-body">
            <h6 class="card-title">International Shipping</h6>
            <p class="card-text">
              Currently, we ship only within India. Global shipping will be announced soon.
            </p>
          </div>
        </div>

        <div class="card mb-3">
          <div class="card-body">
            <h6 class="card-title">Tracking Orders</h6>
            <p class="card-text">
              You will receive email/SMS alerts after dispatch. Track orders from your
              <a href="#" class="text-primary text-decoration-underline">Account</a> page.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

            </ul>
          </div>
          <div class="col-6 col-sm-6 col-md-3">
            <ul class="list-unstyled">
              <li><a href="#">Nordic Chair</a></li>
              <li><a href="#">Kruzo Aero</a></li>
              <li><a href="#">Ergonomic Chair</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div class="border-top pt-4 mt-4 copyright">
      <div class="row">
        <div class="col-lg-6 text-center text-lg-start">
          <p class="mb-2">
            Copyright &copy;<script>document.write(new Date().getFullYear());</script>.
            All Rights Reserved. &mdash; Designed with love by 
            <a href="https://senscript.ai/">Senscript</a>
          </p>
        </div>
        <div class="col-lg-6 text-center text-lg-end">
          <ul class="list-unstyled d-inline-flex ms-auto">
            <li class="me-4"><a href="#">Terms &amp; Conditions</a></li>
            <li><a href="/account/shipping-policy" class="" data-bs-toggle="modal" data-bs-target="#shippingPolicyModal">Shipping Policy</a></li>
          </ul>
        </div>
      </div>
    </div>

  </div>
</footer>
<!-- End Footer Section -->

<!--Toast add to cart-->

<div aria-live="polite" aria-atomic="true" class="position-relative">
  <div id="toast-container" class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 9999;">
    <div id="cart-toast" class="toast align-items-center text-white bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body">
          Book added to cart!
        </div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>
  </div>
</div>

  



		<script src="{% static 'mybookstall/js/bootstrap.bundle.min.js' %}"></script>
		<script src="{% static 'mybookstall/js/tiny-slider.js' %}"></script>
		<script src="{% static 'mybookstall/js/custom.js' %}"></script>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>




<script>
function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let cookie of cookies) {
            cookie = cookie.trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

$(document).ready(function() {
    $('.add-to-cart').click(function() {
        const bookId = $(this).data('book-id');
        const csrfToken = getCookie('csrftoken');

        $.ajax({
            url: "{% url 'cart' %}",  // Replace with your actual URL
            type: "POST",
            data: {
                'book_id': bookId
            },
            headers: {
                'X-CSRFToken': csrfToken
            },
            success: function(response) {
                if (response.success) {
                    $('#cart-count').text(response.cart_count);
                    showToast("Book added to cart!", "success");
                } else {
                    showToast(response.message || "Could not add to cart.", "danger");
                }
            },
            error: function(xhr, status, error) {
                console.log("AJAX Error:", error);
                if (xhr.status === 403) {
                    showToast("Please login to add to cart.", "warning");
                } else {
                    showToast("Please login to add to cart.", "warning");
                }
            }
        });
    });

    function showToast(message, type) {
        const toast = $('#cart-toast');
        toast.find('.toast-body').text(message);
        toast.removeClass('bg-success bg-danger bg-warning').addClass('bg-' + type);
        const toastEl = new bootstrap.Toast(toast[0], { delay: 3000 });
        toastEl.show();
    }
});
</script>



<script>
  document.addEventListener('DOMContentLoaded', function () {
    document.querySelectorAll('.wishlist-btn').forEach(function (btn) {
      btn.addEventListener('click', function () {
        const bookId = this.dataset.bookId;
        fetch("{% url 'add_to_wishlist' %}", {
          method: 'POST',
          headers: {
            'X-CSRFToken': '{{ csrf_token }}',
            'Content-Type': 'application/x-www-form-urlencoded'
          },
          body: new URLSearchParams({
            book_id: bookId
          })
        })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            // Update heart icon
            const icon = btn.querySelector('.wishlist-icon');
            if (data.in_wishlist) {
              icon.classList.remove('far', 'text-dark');
              icon.classList.add('fas', 'text-danger');
            } else {
              icon.classList.remove('fas', 'text-danger');
              icon.classList.add('far', 'text-dark');
            }

            // Update wishlist count badge
            const badge = document.getElementById('wishlist-count');
            if (badge) {
              badge.textContent = data.wishlist_count;
            }
          }
        });
      });
    });
  });
</script>


<script>
document.addEventListener('DOMContentLoaded', function () {
    const loader = document.getElementById('loader');
    const body = document.body;

    // Show loader for link clicks (except modal/read-more)
    document.querySelectorAll('a').forEach(function (link) {
        link.addEventListener('click', function (e) {
            const href = link.getAttribute('href');
            // Skip loader for in-page, no-loader, modals, or toggle links
            if (!href || href.startsWith('#') || link.classList.contains('no-loader')) return;

            e.preventDefault();
            loader.style.display = 'flex';
            setTimeout(() => {
                window.location.href = href;
            }, 300);
        });
    });

    // Show loader for form submits
    document.querySelectorAll('form').forEach(function (form) {
        form.addEventListener('submit', function (e) {
            if (form.classList.contains('no-loader')) return;
            loader.style.display = 'flex';
        });
    });

    // Hide loader when page fully loads
    window.addEventListener('load', function () {
        loader.style.display = 'none';
        body.classList.add('loaded');
    });

    // Handle browser back/forward navigation
    window.addEventListener('pageshow', function (event) {
        const navType = performance.getEntriesByType("navigation")[0]?.type || 'navigate';

        if (event.persisted || navType === "back_forward") {
            loader.style.display = 'none';
            body.classList.add('loaded');
        } else {
            loader.style.display = 'flex';
            setTimeout(() => {
                loader.style.display = 'none';
                body.classList.add('loaded');
            }, 400);
        }
    });
});
</script>



        {% comment %} {% block scripts %}

 <script>
        document.addEventListener('DOMContentLoaded', function () {
            const loader = document.getElementById('loader');
            const body = document.body;
        
            // Show loader for link clicks
            document.querySelectorAll('a').forEach(function (link) {
                link.addEventListener('click', function (e) {
                    const href = link.getAttribute('href');
                    if (!href || href.startsWith('#') || link.classList.contains('no-loader')) return;
        
                    e.preventDefault();
                    loader.style.display = 'flex';
                    setTimeout(() => {
                        window.location.href = href;
                    }, 300);
                });
            });
        
            // Show loader for form submits
            document.querySelectorAll('form').forEach(function (form) {
                form.addEventListener('submit', function () {
                    loader.style.display = 'flex';
                });
            });
        
            // Loader and fade-in on normal load
            window.addEventListener('load', function () {
                loader.style.display = 'none';
                body.classList.add('loaded');
            });
        
            // Handle browser forward/back navigation
            window.addEventListener('pageshow', function (event) {
                const navType = performance.getEntriesByType("navigation")[0].type;
        
                if (event.persisted || navType === "back_forward") {
                    // Don't show loader on cached pages (back/forward restored instantly)
                    loader.style.display = 'none';
                    body.classList.add('loaded');
                } else {
                    // Page was not restored from cache — show loader for forward button
                    loader.style.display = 'flex';
                    setTimeout(() => {
                        loader.style.display = 'none';
                        body.classList.add('loaded');
                    }, 400); // spinner visible for a short time
                }
            });
        });
        </script>
            {% endblock %}

         

{% comment %} <script>
// ✅ Detect page restored from back/forward (from bfcache)
window.addEventListener("pageshow", function (event) {
  if (event.persisted || performance.getEntriesByType("navigation")[0]?.type === "back_forward") {
    document.body.classList.remove("fade-out");
    document.body.classList.remove("loading");
    document.getElementById("loading-spinner").style.display = "none";
  }
});

document.addEventListener("DOMContentLoaded", () => {
  const isBackOrForward = performance.getEntriesByType("navigation")[0]?.type === "back_forward";

  if (!isBackOrForward) {
    requestAnimationFrame(() => {
      document.body.classList.remove("fade-out");
    });
  }

  // 🚫 Skip transition if using back/forward or marked as disabled
  const skipTransition = () =>
    document.body.hasAttribute("data-disable-transition") ||
    performance.getEntriesByType("navigation")[0]?.type === "back_forward";

  // 💡 Link transitions
  document.querySelectorAll("a").forEach(link => {
    link.addEventListener("click", function (e) {
      const href = this.getAttribute("href");
      const target = this.getAttribute("target");
      const disable = this.hasAttribute("data-disable-transition") || skipTransition();

      if (target === "_blank" || disable || !href || href === "#") return;

      e.preventDefault();
      document.body.classList.add("fade-out", "loading");
      setTimeout(() => {
        window.location.href = href;
      }, 400);
    });
  });

  // 💡 Form transitions
  document.querySelectorAll("form").forEach(form => {
    form.addEventListener("submit", function () {
      if (!skipTransition()) {
        document.body.classList.add("fade-out", "loading");
      }
    });
  });
});



</script> {% endcomment %}


            </body>
    </html>
